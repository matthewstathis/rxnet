<body style="font-family:sans-serif; margin:0; background:#e4e4e4;">

  <!-- Dock bar (bottom) -->
  <div style="position:fixed; bottom:0; left:50%; transform:translateX(-50%); background:#2c3e50; padding:10px; border-radius:20px; display:flex; gap:10px; z-index:1000;">
    <button onclick="openPopup('myDocs')">myDocs</button>
    <button onclick="openPopup('Clinical')">Clinical Pharmacology</button>
    <button onclick="openPopup('myWork')">myWork</button>
    <button onclick="openPopup('TempAlert')">TempAlert</button>
  </div>

  <!-- Input Field (yellow bar at bottom) -->
  <div style="position:fixed; bottom:60px; left:0; right:0; padding:10px; background:yellow; text-align:center; font-weight:bold;">
    Search for a Patient, Enter a Prescription Number or Select a function<br>
    <input type="text" id="functionInput" placeholder="Type queue code (e.g., QT) and press Enter" style="padding:5px; width:60%;" onkeydown="handleKey(event)">
  </div>

  <!-- Container for popups -->
  <div id="popupContainer"></div>

  <script>
    const urlMap = {
      myDocs: "https://storeresources.cvsapps.com/?user_ard=MTYzMQ==&employee_ID=MTA5Mzk5MQ==&user_firstname=TWF0dGhldw==&user_lastname=U3RhdGhpcw==&user_title=UGhhcm1hY2lzdA==",
      Clinical: "https://www.clinicalkey.com/pharmacology/",
      myWork: "https://cvs.reflexisinc.com/kernel/views/authenticate/web/CVS.view",
      TempAlert: "https://app.smartsense.co/",
      QT: "https://example.com/triage" // Replace with real internal URL if applicable
    };

    function openPopup(code) {
      const existing = document.querySelector(`.window[data-code="${code}"]`);
      if (existing) return;

      const url = urlMap[code];
      if (!url) return alert("Unrecognized code.");

      const popup = document.createElement("div");
      popup.className = "window";
      popup.dataset.code = code;
      popup.style = `
        position: absolute;
        top: 100px;
        left: 100px;
        width: 600px;
        height: 400px;
        background: white;
        border: 2px solid #2c3e50;
        border-radius: 8px;
        box-shadow: 2px 2px 10px rgba(0,0,0,0.3);
        z-index: 999;
        resize: both;
        overflow: auto;
      `;

      popup.innerHTML = `
        <div style="background: teal; color: white; padding: 8px; cursor: move;">
          ${code} - ${code === 'QT' ? 'Triage Queue' : ''}
          <button onclick="minimizePopup(this)" style="float:right; margin-left:5px;">_</button>
          <button onclick="closePopup(this)" style="float:right;">X</button>
        </div>
        <iframe src="${url}" style="width:100%; height:90%; border:none;"></iframe>
      `;

      makeDraggable(popup);
      document.getElementById("popupContainer").appendChild(popup);
    }

    function handleKey(e) {
      if (e.key === "Enter") {
        const code = e.target.value.trim().toUpperCase();
        if (code) openPopup(code);
        e.target.value = "";
      }
    }

    function closePopup(btn) {
      const win = btn.closest(".window");
      win.remove();
    }

    function minimizePopup(btn) {
      const win = btn.closest(".window");
      const iframe = win.querySelector("iframe");
      if (iframe.style.display === "none") {
        iframe.style.display = "block";
        win.style.height = "400px";
      } else {
        iframe.style.display = "none";
        win.style.height = "40px";
      }
    }

    function makeDraggable(el) {
      const header = el.querySelector("div");
      let isDragging = false, offsetX = 0, offsetY = 0;

      header.onmousedown = function(e) {
        isDragging = true;
        offsetX = e.clientX - el.offsetLeft;
        offsetY = e.clientY - el.offsetTop;
        document.onmousemove = drag;
        document.onmouseup = () => {
          isDragging = false;
          document.onmousemove = null;
        };
      };

      function drag(e) {
        if (isDragging) {
          el.style.left = e.clientX - offsetX + "px";
          el.style.top = e.clientY - offsetY + "px";
        }
      }
    }
  </script>
</body>
